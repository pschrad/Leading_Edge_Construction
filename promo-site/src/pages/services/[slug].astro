---
import ServicePage from '../../layouts/ServicePage.astro';
import { getCollection, getEntryBySlug } from 'astro:content';

export async function getStaticPaths() {
	const services = await getCollection('services');
	return services.map((entry) => ({
		params: { slug: entry.slug },
	}));
}

const { slug } = Astro.params;

if (!slug) {
	throw new Error('Missing service slug parameter.');
}

const entry = await getEntryBySlug('services', slug);

if (!entry) {
	throw new Error(`Service entry for "${slug}" not found.`);
}

const { Content } = await entry.render();
const { data } = entry;
---

<ServicePage data={data} Content={Content} />
